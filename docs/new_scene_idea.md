# 新規ビジュアルシーン アイデアメモ: "Projected Orbs"

## 1. コンセプト（ユーザー提供アイデア）

-   **テーマ**: ミラーボールが作り出す光の効果そのもの。ミラーボール自体はシーンに登場させない。
-   **ビジュアル**: 部屋の壁面に投影された、多数の円形または楕円形の光のスポットライトの集合体で構成される。
-   **コアとなる動き**:
    -   壁面と光の角度に応じて、スポットライトの形状が「真円」から「楕円」へ、またその逆へと滑らかに、そしてダイナミックに変化する。
    -   この有機的な光のダンスが、見ていて楽しい没入感のある体験を生み出す。
-   **具体的な空間イメージ**:
    -   立方体の空間を想定する。
    -   カメラは部屋の角のあたりに位置し、対面の2つの壁を見ている。
    -   天井にある（目には見えない）ミラーボールが回転することで、反射した光が壁面を移動していく。

## 2. 実装計画（リードエンジニア提案）

### a. シーンの構成

-   **基本技術**: 物理的に正確な光線追跡ではなく、`THREE.InstancedMesh` を活用してパフォーマンスを確保しつつ、「それらしく見える」表現を目指す。
-   **空間**: カメラ正面に2枚の巨大な壁（`THREE.Plane`）を90度の角度で配置し、部屋の角を再現する。
-   **光のスポット**: 数百個の円（`THREE.CircleGeometry`）を`InstancedMesh`として効率的に描画する。

### b. アニメーションの仕組み

-   **仮想ミラーボール**: カメラの後方に目に見えない巨大な球（仮想球）を配置。この球面上に、光の発生源となる点を多数ランダムに配置する。
-   **回転と投影**: 仮想球を回転させ、各点の位置ベクトルを「光の方向」とみなす。
-   **交点計算**: 各点から放たれた光線が2枚の壁のどこに交差するかを`Raycaster`で計算し、`InstancedMesh`の各インスタンスをその交点に配置する。
-   **形状変化**: 光線が壁に当たる角度を、光線ベクトルと壁の法線ベクトルの内積から算出。その角度に応じてインスタンスのスケールを引き伸ばし、真円から楕円への自然な変形を表現する。

### c. オーディオとの連動

-   **中域 (Mid)**: 仮想球の回転速度をコントロール。音楽の盛り上がりに合わせて光が壁を走るスピードを変化させる。
-   **低域 (Bass)**: 全ての光スポットの明るさや大きさに影響を与え、ビートに合わせた力強い脈動を表現する。
-   **高域 (Treble)**: 一部の光スポットをランダムに明滅させ（きらめき）、高揚感を演出する。