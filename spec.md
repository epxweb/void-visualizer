# プロジェクト仕様書: Real-time Audio Visualizer "Void"

## 1. 概要

本プロジェクトは、リアルタイム音声入力に反応するVJ（ビジュアルジョッキー）用ビジュアライザーをWebアプリケーションとして開発するものである。DJプレイ中にOBSのソースとして利用されることを主な用途とし、ミニマルでクールな映像表現を目指す。

- **プロジェクト名**: Void (仮称)
- **バージョン**: 1.0.0
- **ターゲットプラットフォーム**: モダンなデスクトップWebブラウザ (Google Chrome, Firefox, Safari)

---

## 2. デザインコンセプト

- **全体的な方向性**: ミニマル、クール、抽象的。
- **カラースキーム**: 基本は**白黒のグレースケール**。ユーザーが色相や明るさを調整できる機能も提供する。
- **テクスチャ**: 全体的に**グレイン（粒状のノイズ）**やテクスチャ感を表現し、デジタルながらも有機的な質感を持たせる。フラットデザインの中にも深みを加える。



---

## 3. 機能要件 (Functional Requirements)

### FR-01: 音声入力と解析

- **FR-01a: 入力ソース**: ブラウザを通じてマイク、またはOSで指定されたオーディオ入力デバイスからのリアルタイム音声を取得できること。
- **FR-01b: 周波数帯域分割**: 音声データを**低域 (Low)・中音域 (Mid)・高域 (High)** の3つの帯域に分割して、それぞれのエネルギー量（音量）を個別に数値化できること。
- **FR-01c: 感度閾値設定**: 各周波数帯域に対して、ビジュアルが反応を開始する**閾値**をユーザーが設定できること。
- **FR-01d: ビート検出**: 低域または指定された周波数帯域の急激なエネルギー上昇を検知し、ビートとしてイベントを発火できること。

### FR-02: ビジュアル描画エンジン

- **FR-02a: 基本要素**: 描画はシンプルな**二次元の図形、線、パーティクル**の組み合わせで構成されること。
- **FR-02b: 音声反応**: FR-01で解析した各帯域のエネルギー量やビート検出イベントに応じて、図形の大きさ、数、色、位置、動きなどがリアルタイムに変化すること。
- **FR-02c: グレインエフェクト**: 画面全体に適用されるグレイン（ノイズ）の強さを調整できること。

### FR-03: ユーザーインターフェース (UI)

- **FR-03a: コントロールパネル**: 以下のパラメータを調整するためのスライダーやボタンを画面上に表示できること。パネルは表示・非表示を切り替え可能とする。
  - 低域 / 中音域 / 高域の感度閾値
  - 全体の色相 (Hue)
  - 全体の明るさ (Brightness)
  - グレインの強さ
  - 背景色 / 前景色
- **FR-03b: 全画面表示**: ボタン一つでブラウザの全画面表示モードに切り替えられること。

### FR-04: シーン管理

- **FR-04a: 複数シーン**: 異なるビジュアルパターンを「シーン」として複数定義できること。（例: シーン1は線が中心、シーン2はパーティクルが中心）
- **FR-04b: 自動遷移**: 設定された時間が経過すると、現在のシーンから次のシーンへ**なめらかに（クロスフェード等で）自動遷移**すること。

---

## 4. 非機能要件 (Non-Functional Requirements)

- **NFR-01: パフォーマンス**: 常に**60fps**での描画を目標とし、スムーズなアニメーションを維持すること。
- **NFR-02: 互換性**: 主要なモダンブラウザの最新版で問題なく動作すること。
- **NFR-03: 運用性**: OBSの「ブラウザソース」機能で簡単に取り込めるよう、シンプルなURL構造と透過背景（オプション）に対応すること。

---

## 5. 技術スタック（推奨）

- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **音声処理**: **Web Audio API**
- **描画ライブラリ**:
  - プロトタイピング: **p5.js**
  - 高パフォーマンス実装: **WebGL** (ライブラリ: **Three.js** または **regl**)
- **UIコントロール**: **Tweakpane** または **dat.GUI**
- **開発環境**: Visual Studio Code + Gemini CLI

---

## 6. 開発マイルストーン

1.  **M1: コア機能PoC (Proof of Concept)**
    - [ ] Web Audio APIでマイク入力を取得。
    - [ ] 全体の音量を取得し、p5.jsで円の大きさを変化させる。
2.  **M2: 音声解析エンジンの実装**
    - [ ] 音声を低・中・高の3帯域に分割。
    - [ ] 各帯域の音量に応じて、異なる図形パラメータを制御する。
    - [ ] シンプルなビート検出アルゴリズムを実装する。
3.  **M3: ビジュアルシーンの開発**
    - [ ] ミニマルなデザインのビジュアルシーンを最低3種類作成する。
    - [ ] WebGL (Three.js) を導入し、パーティクル表現とグレインエフェクト（シェーダー）を実装する。
4.  **M4: UIとコントロールの実装**
    - [ ] Tweakpaneを導入し、機能要件で定義されたパラメータを操作できるようにする。
    - [ ] 全画面表示機能を実装する。
5.  **M5: シーン管理と仕上げ**
    - [ ] シーンの自動遷移とクロスフェード機能を実装する。
    - [ ] OBSでの利用を想定した最終的なパフォーマンスチューニングとデバッグを行う。